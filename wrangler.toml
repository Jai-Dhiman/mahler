name = "mahler"
main = "src/workers/router.py"
compatibility_date = "2024-12-01"
compatibility_flags = ["python_workers"]

[observability]
enabled = true

# Cron triggers for scheduled workers
# Times are in UTC (ET = UTC-5 during EST, UTC-4 during EDT)
[triggers]
crons = [
    "35 14 * * 1-5",     # morning_scan: 9:35 AM ET (14:35 UTC during EST)
    "0 17 * * 1-5",      # midday_check: 12:00 PM ET (17:00 UTC during EST)
    "30 20 * * 1-5",     # afternoon_scan: 3:30 PM ET (20:30 UTC during EST)
    "15 21 * * 1-5",     # eod_summary: 4:15 PM ET (21:15 UTC during EST)
    "*/5 14-21 * * 1-5", # position_monitor: every 5 min during market hours
]

# D1 SQLite database for persistent storage
[[d1_databases]]
binding = "DB"
database_name = "mahler-db"
database_id = "e5d7abaf-7e53-42ab-9b15-15e0cd3b41c1"

# KV namespace for fast state (circuit breakers, rate limits)
[[kv_namespaces]]
binding = "mahler-kv"
id = "7d216d16fd474347b4f978b322f9c062"

# Environment variables (non-secret)
[vars]
ENVIRONMENT = "paper"
LOG_LEVEL = "INFO"
